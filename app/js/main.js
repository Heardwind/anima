"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function canvasApp(){var e,t,a,n,r,i,l,s,o,c,u,d,h,f,v,m,p,g,y,b,x,A,k,w,C,M,P,S,E,I,L,_,j,V,Y,X,q,D,T,Z=arguments.length>0&&void 0!==arguments[0]?arguments[0]:180,z=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[70,255,140],N=.7,O=document.getElementById("canvasOne"),B=O.getContext("2d");function H(){n=(a=1)-1,r=8,o=z[0],c=z[1],u=z[2],P="rgba("+o+","+c+","+u+",",s=1,e=O.width,t=O.height,f=e/2,v=t/2,m=(d=320)-2,i={},l={},k=.1,w=.1,C=.1,M=-0,x=2.5,0,y=0,b=-3-Z,A=-750,g=2*Math.PI/5e3,p=0,setInterval(R,10/24)}function R(){if(++n>=a)for(n=0,V=0;V<r;V++){Y=2*Math.random()*Math.PI,X=Math.acos(2*Math.random()-1),q=Z*Math.sin(X)*Math.cos(Y),D=Z*Math.sin(X)*Math.sin(Y),T=Z*Math.cos(X);var l=W(q,y+D,b+T,.002*q,.002*D,.002*T);l.attack=50,l.hold=50,l.decay=100,l.initValue=0,l.holdValue=s,l.lastValue=0,l.stuckTime=90+20*Math.random(),l.accelX=0,l.accelY=M,l.accelZ=0}for(p=(p+g)%(2*Math.PI),E=Math.sin(p),I=Math.cos(p),B.fillStyle="#000000",B.fillRect(0,0,e,t),l=i.first;null!=l;)S=l.next,l.age++,l.age>l.stuckTime&&(l.velX+=l.accelX+k*(2*Math.random()-1),l.velY+=l.accelY+w*(2*Math.random()-1),l.velZ+=l.accelZ+C*(2*Math.random()-1),l.x+=l.velX,l.y+=l.velY,l.z+=l.velZ),L=I*l.x+E*(l.z-b),_=-E*l.x+I*(l.z-b)+b,h=N*d/(d-_),l.projX=L*h+f,l.projY=l.y*h+v,l.age<l.attack+l.hold+l.decay?l.age<l.attack?l.alpha=(l.holdValue-l.initValue)/l.attack*l.age+l.initValue:l.age<l.attack+l.hold?l.alpha=l.holdValue:l.age<l.attack+l.hold+l.decay&&(l.alpha=(l.lastValue-l.holdValue)/l.decay*(l.age-l.attack-l.hold)+l.holdValue):l.dead=!0,l.projX>e||l.projX<0||l.projY<0||l.projY>t||_>m||l.dead?F(l):(j=(j=1-_/A)>1?1:j<0?0:j,B.fillStyle=P+j*l.alpha+")",B.beginPath(),B.arc(l.projX,l.projY,h*x,0,2*Math.PI,!1),B.fill(),B.closePath()),l=S}function W(e,t,a,n,r,s){var o;return null!=l.first?null!=(o=l.first).next?(l.first=o.next,o.next.prev=null):l.first=null:o={},null==i.first?(i.first=o,o.prev=null,o.next=null):(o.next=i.first,i.first.prev=o,i.first=o,o.prev=null),o.x=e,o.y=t,o.z=a,o.velX=n,o.velY=r,o.velZ=s,o.age=0,o.dead=!1,Math.random()<.5?o.right=!0:o.right=!1,o}function F(e){i.first==e?null!=e.next?(e.next.prev=null,i.first=e.next):i.first=null:null==e.next?e.prev.next=null:(e.prev.next=e.next,e.next.prev=e.prev),null==l.first?(l.first=e,e.prev=null,e.next=null):(e.next=l.first,l.first.prev=e,l.first=e,e.prev=null)}return H(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[o,c,u];P="rgba("+e[0]+","+e[1]+","+e[2]+","}}var Anima=function(){function e(t){var a=this;_classCallCheck(this,e),_defineProperty(this,"handleScroll",(function(e){e.preventDefault();var t=Date.now(),n=a.step;t-a.lastAnimation<a.delay||(e.deltaY<0||(a.step=a.step===a.steps?a.steps:++a.step),n!=a.step&&a.upd(),a.lastAnimation=t)})),this.element=document.querySelector(t),this.sentinelElement=document.querySelector(".sentinel"),this.cloudguardElement=document.querySelector(".cloudguard"),this.navigationItems=this.element.querySelectorAll(".navigation li"),this.steps=4,this.step=1,this.delay=2e3,this.lastAnimation=0,this.setup(),this.changeColor=canvasApp(160,[1,136,245]),this.renderStaticPath(this.sentinelElement)}return _createClass(e,[{key:"setup",value:function(){document.addEventListener("wheel",this.handleScroll,{passive:!1}),document.addEventListener("touchmove",this.handleScroll,{passive:!1}),document.addEventListener("touchstart",this.handleScroll,{passive:!1}),document.addEventListener("touchend",this.handleScroll,{passive:!1})}},{key:"getCoords",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e.getBoundingClientRect(),n=t?a.x+a.width/2:a.x+20,r=t?a.y+a.height/2:a.y+20;return[n,r]}},{key:"renderStaticPath",value:function(e){var t=this,a=e.querySelectorAll("[data-bind]"),n=Array.from(a).map((function(t){return e.querySelector(t.dataset.bind)}));if(a.length&&n.length){var r=document.createElementNS("http://www.w3.org/2000/svg","svg"),i="0 0 ".concat(e.offsetWidth," ").concat(e.offsetHeight);r.classList.add("path"),r.setAttribute("viewBox",i);var l=Array.from(a).map((function(e){return t.getCoords(e)})),s=Array.from(n).map((function(e){return t.getCoords(e,!0)})),o=a.length,c=[];return Array.from(Array(o).keys()).forEach((function(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","line");n.setAttribute("x1",l[t][0]),n.setAttribute("y1",l[t][1]),n.setAttribute("x2",s[t][0]),n.setAttribute("y2",s[t][1]),n.setAttribute("stroke","white"),n.setAttribute("stroke-opacity","0.3"),n.setAttribute("stroke-dasharray","2 2"),a[t].dataset.frame&&n.classList.add("path_frame_".concat(a[t].dataset.frame)),r.appendChild(n),c.push(n)})),e.appendChild(r),a.forEach((function(e){var t=document.createElement("div");t.classList.add("dot");var a=document.createElement("span");t.appendChild(a),e.appendChild(t)})),{lines:c,elems1:a,elems2:n}}return null}},{key:"renderDynamicPath",value:function(e){var t=this,a=this.renderStaticPath(e);a&&setInterval((function(){var e=Array.from(a.elems1).map((function(e){return t.getCoords(e)})),n=Array.from(a.elems2).map((function(e){return t.getCoords(e,!0)}));a.lines.forEach((function(t,a){t.setAttribute("x1",e[a][0]),t.setAttribute("y1",e[a][1]),t.setAttribute("x2",n[a][0]),t.setAttribute("y2",n[a][1])}))}),100)}},{key:"delayI",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}},{key:"rotateHandler",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".cloudguard .content",a=9e4,n=this.element.querySelector(t),r=!1;setInterval((function(){e=r?"rotate(60deg)":"rotate(-60deg)",n.style.transform=e,r=!r}),a)}},{key:"setNavItem",value:function(e){this.navigationItems.length&&(this.navigationItems[e-1].classList.remove("active"),this.navigationItems[e].classList.add("active"))}},{key:"upd",value:function(){var e=this;switch(this.step){case 1:break;case 2:this.element.classList.add("frame_1"),this.changeColor([70,240,157]),setTimeout((function(){e.element.classList.add("frame_2"),e.renderDynamicPath(e.cloudguardElement)}),1e3);break;case 3:this.rotateHandler(),this.element.classList.add("frame_3");break;case 4:this.element.classList.add("frame_4")}this.setNavItem(this.step-1)}}]),e}();function init(){new Anima(".anima")}document.addEventListener("DOMContentLoaded",init);