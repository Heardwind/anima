"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function canvasApp(){var e,t,n,a,r,i,l,s,o,c,u,d,h,f,v,m,p,g,y,b,k,w,x,A,E,C,L,S,M,P,I,_,Y,j,V,X,T,q,D,O=arguments.length>0&&void 0!==arguments[0]?arguments[0]:180,Z=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[70,255,140],z=.7,B=document.getElementById("canvasOne"),N=B.getContext("2d");function H(){a=(n=1)-1,r=8,o=Z[0],c=Z[1],u=Z[2],L="rgba("+o+","+c+","+u+",",s=1,e=B.width,t=B.height,f=e/2,v=t/2,m=(d=320)-2,i={},l={},x=.1,A=.1,E=.1,C=-0,k=2.5,0,y=0,b=-3-O,w=-750,g=2*Math.PI/5e3,p=0,setInterval(R,10/24)}function R(){if(++a>=n)for(a=0,j=0;j<r;j++){V=2*Math.random()*Math.PI,X=Math.acos(2*Math.random()-1),T=O*Math.sin(X)*Math.cos(V),q=O*Math.sin(X)*Math.sin(V),D=O*Math.cos(X);var l=W(T,y+q,b+D,.002*T,.002*q,.002*D);l.attack=50,l.hold=50,l.decay=100,l.initValue=0,l.holdValue=s,l.lastValue=0,l.stuckTime=90+20*Math.random(),l.accelX=0,l.accelY=C,l.accelZ=0}for(p=(p+g)%(2*Math.PI),M=Math.sin(p),P=Math.cos(p),N.fillStyle="#000000",N.fillRect(0,0,e,t),l=i.first;null!=l;)S=l.next,l.age++,l.age>l.stuckTime&&(l.velX+=l.accelX+x*(2*Math.random()-1),l.velY+=l.accelY+A*(2*Math.random()-1),l.velZ+=l.accelZ+E*(2*Math.random()-1),l.x+=l.velX,l.y+=l.velY,l.z+=l.velZ),I=P*l.x+M*(l.z-b),_=-M*l.x+P*(l.z-b)+b,h=z*d/(d-_),l.projX=I*h+f,l.projY=l.y*h+v,l.age<l.attack+l.hold+l.decay?l.age<l.attack?l.alpha=(l.holdValue-l.initValue)/l.attack*l.age+l.initValue:l.age<l.attack+l.hold?l.alpha=l.holdValue:l.age<l.attack+l.hold+l.decay&&(l.alpha=(l.lastValue-l.holdValue)/l.decay*(l.age-l.attack-l.hold)+l.holdValue):l.dead=!0,l.projX>e||l.projX<0||l.projY<0||l.projY>t||_>m||l.dead?F(l):(Y=(Y=1-_/w)>1?1:Y<0?0:Y,N.fillStyle=L+Y*l.alpha+")",N.beginPath(),N.arc(l.projX,l.projY,h*k,0,2*Math.PI,!1),N.fill(),N.closePath()),l=S}function W(e,t,n,a,r,s){var o;return null!=l.first?null!=(o=l.first).next?(l.first=o.next,o.next.prev=null):l.first=null:o={},null==i.first?(i.first=o,o.prev=null,o.next=null):(o.next=i.first,i.first.prev=o,i.first=o,o.prev=null),o.x=e,o.y=t,o.z=n,o.velX=a,o.velY=r,o.velZ=s,o.age=0,o.dead=!1,Math.random()<.5?o.right=!0:o.right=!1,o}function F(e){i.first==e?null!=e.next?(e.next.prev=null,i.first=e.next):i.first=null:null==e.next?e.prev.next=null:(e.prev.next=e.next,e.next.prev=e.prev),null==l.first?(l.first=e,e.prev=null,e.next=null):(e.next=l.first,l.first.prev=e,l.first=e,e.prev=null)}return H(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[o,c,u];L="rgba("+e[0]+","+e[1]+","+e[2]+","}}var Anima=function(){function e(t){var n=this;_classCallCheck(this,e),_defineProperty(this,"handleScroll",(function(e){e.preventDefault();var t=Date.now(),a=n.step;t-n.lastAnimation<n.delay||(e.deltaY<0||(n.step=n.step===n.steps?n.steps:++n.step),a!=n.step&&n.upd(),n.lastAnimation=t)})),this.element=document.querySelector(t),this.sentinelElement=document.querySelector(".sentinel"),this.cloudguardElement=document.querySelector(".cloudguard"),this.navigationItems=this.element.querySelectorAll(".navigation li"),this.steps=4,this.step=1,this.delay=2e3,this.lastAnimation=0,this.parenElemCoords=this.elemDocCoords(this.element),this.setup(),this.changeColor=canvasApp(160,[1,136,245]),this.renderStaticPath(this.sentinelElement)}return _createClass(e,[{key:"setup",value:function(){this.element.addEventListener("wheel",this.handleScroll,{passive:!1}),this.element.addEventListener("touchmove",this.handleScroll,{passive:!1}),this.element.addEventListener("touchstart",this.handleScroll,{passive:!1}),this.element.addEventListener("touchend",this.handleScroll,{passive:!1})}},{key:"removeEventListeners",value:function(){this.element.removeEventListener("wheel",this.handleScroll,{passive:!1}),this.element.removeEventListener("touchmove",this.handleScroll,{passive:!1}),this.element.removeEventListener("touchstart",this.handleScroll,{passive:!1}),this.element.removeEventListener("touchend",this.handleScroll,{passive:!1})}},{key:"elemDocCoords",value:function(e){var t=e.getBoundingClientRect(),n=document.body,a=document.documentElement,r=window.pageYOffset||a.scrollTop||n.scrollTop,i=window.pageXOffset||a.scrollLeft||n.scrollLeft,l=a.clientTop||n.clientTop||0,s=a.clientLeft||n.clientLeft||0,o=t.top+r-l,c=t.left+i-s;return{top:Math.round(o),left:Math.round(c)}}},{key:"getCoords",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parenElemCoords.top-window.pageYOffset,a=e.getBoundingClientRect(),r=t?a.x+a.width/2:a.x+20,i=t?a.y+a.height/2-n:a.y+20-n;return[r,i]}},{key:"renderStaticPath",value:function(e){var t=this,n=e.querySelectorAll("[data-bind]"),a=Array.from(n).map((function(t){return e.querySelector(t.dataset.bind)}));if(n.length&&a.length){var r=document.createElementNS("http://www.w3.org/2000/svg","svg"),i="0 0 ".concat(e.offsetWidth," ").concat(e.offsetHeight);r.classList.add("path"),r.setAttribute("viewBox",i);var l=Array.from(n).map((function(e){return t.getCoords(e)})),s=Array.from(a).map((function(e){return t.getCoords(e,!0)})),o=n.length,c=[];return Array.from(Array(o).keys()).forEach((function(e,t){var a=document.createElementNS("http://www.w3.org/2000/svg","line");a.setAttribute("x1",l[t][0]),a.setAttribute("y1",l[t][1]),a.setAttribute("x2",s[t][0]),a.setAttribute("y2",s[t][1]),a.setAttribute("stroke","white"),a.setAttribute("stroke-opacity","0.3"),a.setAttribute("stroke-dasharray","2 2"),n[t].dataset.frame&&a.classList.add("path_frame_".concat(n[t].dataset.frame)),r.appendChild(a),c.push(a)})),e.appendChild(r),n.forEach((function(e){var t=document.createElement("div");t.classList.add("dot");var n=document.createElement("span");t.appendChild(n),e.appendChild(t)})),{lines:c,elems1:n,elems2:a}}return null}},{key:"renderDynamicPath",value:function(e){var t=this,n=this.renderStaticPath(e);n&&setInterval((function(){var e=Array.from(n.elems1).map((function(e){return t.getCoords(e)})),a=Array.from(n.elems2).map((function(e){return t.getCoords(e,!0)}));n.lines.forEach((function(t,n){t.setAttribute("x1",e[n][0]),t.setAttribute("y1",e[n][1]),t.setAttribute("x2",a[n][0]),t.setAttribute("y2",a[n][1])}))}),100)}},{key:"delayI",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}},{key:"rotateHandler",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".cloudguard .content",n=9e4,a=this.element.querySelector(t),r=!1;setInterval((function(){e=r?"rotate(60deg)":"rotate(-60deg)",a.style.transform=e,r=!r}),n)}},{key:"setNavItem",value:function(e){this.navigationItems.length&&(this.navigationItems[e-1].classList.remove("active"),this.navigationItems[e].classList.add("active"))}},{key:"upd",value:function(){var e=this;switch(this.step){case 1:break;case 2:this.element.classList.add("frame_1"),this.changeColor([70,240,157]),setTimeout((function(){e.element.classList.add("frame_2"),e.renderDynamicPath(e.cloudguardElement)}),1e3);break;case 3:this.rotateHandler(),this.element.classList.add("frame_3");break;case 4:this.element.classList.add("frame_4"),this.removeEventListeners()}this.setNavItem(this.step-1)}}]),e}();function init(){new Anima(".anima")}document.addEventListener("DOMContentLoaded",init);